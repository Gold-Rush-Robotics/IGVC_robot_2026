launch:
  # Robot State Publisher
  - node:
      pkg: robot_state_publisher
      exec: robot_state_publisher
      name: robot_state_publisher
      output: screen
      param:
        - name: use_sim_time
          value: false
        - name: robot_description 
          value: $(command 'xacro $(find-pkg-share igvc_test_description)/urdf/robots/test_robot.urdf.xacro')
  # ROS2 Control Node
  - node:
      pkg: controller_manager
      exec: ros2_control_node
      name: controller_manager
      output: screen
      param:
        - name: use_sim_time
          value: false
        - from: $(find-pkg-share igvc_test_bringup)/config/controllers.yaml

  # Joint State Broadcaster Spawner
  - node:
      pkg: controller_manager
      exec: spawner
      name: joint_state_broadcaster_spawner
      args: joint_state_broadcaster --controller-manager /controller_manager

  # Diff Drive Controller Spawner
  - node:
      pkg: controller_manager
      exec: spawner
      name: diff_drive_spawner
      args: diff_drive_controller --controller-manager /controller_manager

  # Joystick Node
  - node:
      pkg: joy
      exec: joy_node
      name: joy_node
      param:
        - name: dev
          value: /dev/input/js0
        - name: deadzone
          value: 0.3
        - name: autorepeat_rate
          value: 20.0

  # Teleop Twist Joy Node
  - node:
      pkg: teleop_twist_joy
      exec: teleop_node
      name: teleop_twist_joy_node
      param:
        - from: $(find-pkg-share igvc_test_bringup)/config/xbox-holonomic.config.yaml
      remap:
        - from: /cmd_vel
          to: /diff_drive_controller/cmd_vel
